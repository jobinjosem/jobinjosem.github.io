<!doctype html><html lang="en" ><head> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4445781280689625" crossorigin="anonymous"></script> <script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="SNAT Port Exhaustion in AKS" /><meta property="og:locale" content="en" /><meta name="description" content="This post explains what SNAT port exhaustion is and outlines preventive measures to avoid it." /><meta property="og:description" content="This post explains what SNAT port exhaustion is and outlines preventive measures to avoid it." /><link rel="canonical" href="https://www.jobinjose.com/technical-writing/2024/01/12/snat-port-exhaustion-in-aks.html" /><meta property="og:url" content="https://www.jobinjose.com/technical-writing/2024/01/12/snat-port-exhaustion-in-aks.html" /><meta property="og:site_name" content="Jobin Jose" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-12T12:59:59+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SNAT Port Exhaustion in AKS" /><meta name="twitter:site" content="@jobinjosem" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-01-12T12:59:59+01:00","datePublished":"2024-01-12T12:59:59+01:00","description":"This post explains what SNAT port exhaustion is and outlines preventive measures to avoid it.","headline":"SNAT Port Exhaustion in AKS","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.jobinjose.com/technical-writing/2024/01/12/snat-port-exhaustion-in-aks.html"},"url":"https://www.jobinjose.com/technical-writing/2024/01/12/snat-port-exhaustion-in-aks.html"}</script><title>SNAT Port Exhaustion in AKS | Jobin Jose</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Jobin Jose"><meta name="application-name" content="Jobin Jose"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } }, tex2jax: { inlineMath: [ ['$', '$'] ], displayMath: [ ['$$', '$$'], ['\\[', '\\]'] ], processEscapes: true, } }); MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" ></script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/jobin.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">Jobin Jose</a></div><div class="site-subtitle fst-italic">..that regular things, but in my own voice...</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul><div class="align-items-center w-100" style="text-align: center; margin-bottom: 1rem;"> <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fjobinjosem.github.io&count_bg=%23555555&title_bg=%23242424&icon=myspace.svg&icon_color=%23E7E7E7&title=Visitors&edge_flat=false" /></div><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/jobinjosem" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/jobinjosem" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['jobinjosem','hotmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>SNAT Port Exhaustion in AKS</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><link rel="stylesheet" href="https://unpkg.com/applause-button/dist/applause-button.css"> <script src="https://unpkg.com/applause-button/dist/applause-button.js"></script><h1 data-toc-skip>SNAT Port Exhaustion in AKS</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1705060799" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jan 12, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/jobinjosem">Jobin Jose</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="880 words" > <em>4 min</em> read</span></div></div></div><div class="post-content"><h2 id="snat-port-exhaustion-in-aks"><span class="me-2">SNAT Port Exhaustion in AKS</span><a href="#snat-port-exhaustion-in-aks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Kubernetes networking is complex, and understanding Source Network Address Translation (SNAT) is crucial for seamless communication within clusters. In this post, I will explain SNAT Port Exhaustion in AKS.</p><p>SNAT Port Exhaustion occurs when the available ports for Source Network Address Translation are depleted. If not addressed properly, it can block the outbound connectivity of your entire cluster and disrupt the applications.</p><h3 id="understanding-snat-source-network-address-translation"><span class="me-2">Understanding SNAT (Source Network Address Translation)</span><a href="#understanding-snat-source-network-address-translation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>SNAT is a networking technique that enables multiple devices in a network to share a single public IP address. It plays a pivotal role in Kubernetes networking, facilitating efficient communication between pods and external resources.</p><p>One of the key techniques under SNAT’s umbrella is IP Masquerading, a simplified form of network address translation that hides the internal IP addresses of pods within an AKS cluster behind the public IP address of the cluster’s nodes or a load balancer. This process allows outgoing traffic from the pods to appear as if it originates from the node’s public IP, enhancing security and simplifying network configurations. Essentially, IP Masquerading ensures that external entities see communication from the AKS cluster as coming from a single, unified source.</p><p>An AKS cluster with an outbound type load balancer with one public IP will have 64,000 ports eligible for SNAT. These ports will be allocated to the backend VMs. The number of ports allocated to each VM depends on the number of nodes in the cluster. SNAT ports are allocated for each outbound connection to the same destination and destination port. When applications run on the node and make too many requests, the ports allocated to the node become unavailable, and port exhaustion occurs.</p><h3 id="identifying-snat-port-exhaustion-issues"><span class="me-2">Identifying SNAT Port Exhaustion Issues</span><a href="#identifying-snat-port-exhaustion-issues" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Azure Standard Load Balancer has metrics that show the status of SNAT ports usage. To find the SNAT connection statistics:</p><ul><li><p>Select <code class="language-plaintext highlighter-rouge">SNAT Connections</code> as the metric type and <code class="language-plaintext highlighter-rouge">Sum</code> as the aggregation.</p><li><p>Group by <code class="language-plaintext highlighter-rouge">Connection State</code> to represent successful and failed SNAT connection counts by different lines.</p></ul><p>A volume of failed connections greater than zero indicates SNAT port exhaustion.</p><h3 id="preventive-measures"><span class="me-2">Preventive Measures</span><a href="#preventive-measures" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The recommended way for outbound connectivity is to use a NAT gateway. Azure NAT gateway allocates ports dynamically from the entire pool of ports. It also employs a port reuse technique that makes it less likely to experience connection issues. Sometimes, migrating traffic from a load balancer to NAT gateway may not be an option due to different constraints and known limitations of NAT gateway. However, there are some steps you can easily configure that will help reduce the occurrence of port exhaustion:</p><ul><li><p><strong>Use private link or service endpoints wherever possible.</strong></p><p>Services that send traffic over private link or service endpoints do not use SNAT functionality and hence do not consume SNAT ports for outbound connectivity.</p><li><p><strong>Configure Idle timeout on load balancer.</strong></p><p>Choose a value with a small number. In most cases, 4 minutes should be enough. The idle connections get released after this timeout, making the port available for newer connections.</p><li><p><strong>Configure the pre-allocated number of ports in the Load balancer.</strong></p><p>A load balancer with a single public IP will have 64,000 allocatable ports. By default, the port number allocated will be a conservative number. By doing the calculations, we can manually set the port numbers each node can have.</p><li><p><strong>Add additional public IP’s to the external load balancer.</strong></p><p>Each public IP has 64,000 available ports. Attaching an additional public IP will add another 64,000 ports that can be allocated to the nodes and used for outbound connectivity.</p><li><p><strong>Use a greater number of nodes with smaller sizes.</strong></p><p>Using more smaller nodes reduces the blast radius during outages. If a faulty application has three replicas, only the nodes with the faulty app are affected, minimizing impact. Consider the billing implications, analyze, and choose a balanced VM size for performance and cost.</p><li><p><strong>Use sensible maxpods values.</strong></p><p>Establishing a sensible maximum pods per node helps restrict the blast radius, thereby minimizing the impact.</p></ul><p>No matter whatever technique you use, a faulty application can consume all the ports on a node and block other applications from establishing outbound connectivity. The best solution is to fine-tune your application to make it connection-efficient. You may adapt techniques like connection pooling, reuse connections, use less aggressive retry logic, and use keep-alives to reset the outbound idle timeout.</p><h3 id="what-steps-to-take-in-the-event-of-snat-port-exhaustion"><span class="me-2">What steps to take in the event of SNAT port exhaustion.</span><a href="#what-steps-to-take-in-the-event-of-snat-port-exhaustion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Sometimes, there can be a faulty pod that consumes all the ports on a node, affecting all other pods running on the same node. A swift response is to identify and isolate the faulty application. Other metrics, such as container_sockets, can be utilized for this purpose. Compare the pod for which an increase in container_sockets occurred against the time at which port exhaustion happened, providing insight into the pod causing the SNAT port exhaustion. Once the pod is identified, move the other pods running on the node to other nodes in the cluster. This way, we can mitigate the impact on other pods until the faulty application is fixed.</p><h3 id="conclusion-mitigating-snat-port-exhaustion-challenges-in-kubernetes"><span class="me-2">Conclusion: Mitigating SNAT Port Exhaustion Challenges in Kubernetes</span><a href="#conclusion-mitigating-snat-port-exhaustion-challenges-in-kubernetes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In conclusion, understanding, monitoring, and implementing preventive measures are crucial steps in mitigating SNAT Port Exhaustion challenges in Kubernetes. By following best practices and staying vigilant, you can ensure the smooth operation of your clusters.</p></div><div class="post-tail-wrapper text-muted"><div class="applause-button"> <applause-button class="mb6" color=rgb(79,177,186) url=https://www.jobinjose.com/technical-writing/2024/01/12/snat-port-exhaustion-in-aks.html> </applause-button></div><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/technical-writing/'>technical-writing</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/azure/" class="post-tag no-text-decoration">azure</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration">kubernetes</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SNAT%20Port%20Exhaustion%20in%20AKS%20-%20Jobin%20Jose&url=https%3A%2F%2Fwww.jobinjose.com%2Ftechnical-writing%2F2024%2F01%2F12%2Fsnat-port-exhaustion-in-aks.html" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SNAT%20Port%20Exhaustion%20in%20AKS%20-%20Jobin%20Jose&u=https%3A%2F%2Fwww.jobinjose.com%2Ftechnical-writing%2F2024%2F01%2F12%2Fsnat-port-exhaustion-in-aks.html" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwww.jobinjose.com%2Ftechnical-writing%2F2024%2F01%2F12%2Fsnat-port-exhaustion-in-aks.html&text=SNAT%20Port%20Exhaustion%20in%20AKS%20-%20Jobin%20Jose" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/technical-writing/azure/2023/10/07/certificate-handling.html">Certificate Management</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/azure/">azure</a> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/wsl/">wsl</a> <a class="post-tag btn btn-outline-primary" href="/tags/appservice-certificates/">appservice-certificates</a> <a class="post-tag btn btn-outline-primary" href="/tags/backstage/">backstage</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/mkdocs/">mkdocs</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/azure/2023/08/24/azure-workload-identity.html" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1692868342" data-df="ll" > Aug 24, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>Azure Workload Identity on Kubernetes</h4><div class="text-muted small"><p> Deployed workloads within Kubernetes clusters necessitate Azure AD application credentials or managed identities for accessing Azure AD protected resources, like Azure Key Vault and Microsoft Graph...</p></div></div></a></div><div class="col"> <a href="/wsl/2022/03/01/oh-my-posh-bash.html" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1646125942" data-df="ll" > Mar 1, 2022 </em><h4 class="pt-0 my-2" data-toc-skip>WSL Bash customization using oh-my-posh</h4><div class="text-muted small"><p> In this post, I will explain how I tweaked my bash prompt in WSL using oh-my-posh. Below are the steps I followed to personalize my bash shell. Install oh-my-posh. sudo wget https://github.com/Ja...</p></div></div></a></div><div class="col"> <a href="/technical-writing/azure/2023/10/07/certificate-handling.html" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1696630798" data-df="ll" > Oct 7, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>Certificate Management</h4><div class="text-muted small"><p> Are you frequently handling SSL/TLS certificates and struggling with multiple formats for different purposes? Managing certificates can be cumbersome, but Azure App Service Certificates streamline ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/technical-writing/azure/2023/10/07/certificate-handling.html" class="btn btn-outline-primary" prompt="Older" ><p>Certificate Management</p></a><div class="btn btn-outline-primary disabled" prompt="Newer" ><p>-</p></div></div><script src="https://utteranc.es/client.js" repo="jobinjosem/jobinjosem.github.io" issue-term="pathname" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/azure/">azure</a> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/wsl/">wsl</a> <a class="post-tag btn btn-outline-primary" href="/tags/appservice-certificates/">appservice-certificates</a> <a class="post-tag btn btn-outline-primary" href="/tags/backstage/">backstage</a> <a class="post-tag btn btn-outline-primary" href="/tags/blog/">blog</a> <a class="post-tag btn btn-outline-primary" href="/tags/mkdocs/">mkdocs</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a></p><p>© 2024 <a href="https://twitter.com/jobinjosem">Jobin Jose</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
